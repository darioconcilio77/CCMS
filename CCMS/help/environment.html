<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Environments â€“ CCMS Help</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>

<header class="topbar">
  <button class="topbar__menu-btn" aria-label="Toggle menu">&#9776;</button>
  <a href="index.html" class="topbar__logo">
    <div class="topbar__logo-icon">D4P</div>
    <div>
      <div class="topbar__product">CCMS Help</div>
      <div class="topbar__subtitle">Cloud Customer Management Solution</div>
    </div>
  </a>
  <div class="topbar__spacer"></div>
  <span class="topbar__version">v0.0.2.0 Â· BC 27.0+</span>
</header>

<div class="shell">
  <nav class="sidebar" aria-label="Help navigation">
    <div class="sidebar__inner">
      <span class="sidebar__section-title">Documentation</span>
      <ul class="sidebar__nav">
        <li><a href="index.html"><span class="nav-icon">ğŸ </span>Home</a></li>
        <li><a href="getting-started.html"><span class="nav-icon">ğŸš€</span>Getting Started</a></li>
      </ul>
      <span class="sidebar__section-title">Configuration</span>
      <ul class="sidebar__nav">
        <li><a href="setup.html"><span class="nav-icon">âš™ï¸</span>Setup</a></li>
        <li><a href="auth.html"><span class="nav-icon">ğŸ”</span>Authentication</a></li>
        <li><a href="permissions.html"><span class="nav-icon">ğŸ›¡ï¸</span>Permissions</a></li>
      </ul>
      <span class="sidebar__section-title">Core Data</span>
      <ul class="sidebar__nav">
        <li><a href="customer.html"><span class="nav-icon">ğŸ¢</span>Customers</a></li>
        <li><a href="tenant.html"><span class="nav-icon">ğŸŒ</span>Tenants</a></li>
        <li><a href="environment.html"><span class="nav-icon">ğŸ–¥ï¸</span>Environments</a></li>
      </ul>
      <span class="sidebar__section-title">Operations</span>
      <ul class="sidebar__nav">
        <li><a href="extension.html"><span class="nav-icon">ğŸ§©</span>Extensions</a></li>
        <li><a href="backup.html"><span class="nav-icon">ğŸ’¾</span>Backup</a></li>
        <li><a href="capacity.html"><span class="nav-icon">ğŸ“Š</span>Capacity</a></li>
        <li><a href="features.html"><span class="nav-icon">ğŸš¦</span>Features</a></li>
        <li><a href="session.html"><span class="nav-icon">ğŸ‘¤</span>Sessions</a></li>
        <li><a href="operation.html"><span class="nav-icon">â³</span>Operations</a></li>
      </ul>
      <span class="sidebar__section-title">Advanced</span>
      <ul class="sidebar__nav">
        <li><a href="telemetry.html"><span class="nav-icon">ğŸ“¡</span>Telemetry</a></li>
        <li><a href="general.html"><span class="nav-icon">ğŸ›ï¸</span>Role Center &amp; API</a></li>
      </ul>
    </div>
  </nav>

  <main class="main">
    <div class="content">

      <div class="page-header">
        <div class="page-header__breadcrumb">
          <a href="index.html">Home</a><span>â€º</span> Environments
        </div>
        <h1>Environments</h1>
        <div class="page-header__meta">
          <span class="badge badge--namespace">D4P.CCMS.Environment</span>
          <span class="badge badge--module">Table 62002</span>
        </div>
      </div>

      <p>
        The Environment module is the <strong>core administrative module</strong> of CCMS.
        It provides full lifecycle management of Dynamics 365 Business Central environments
        through the <strong>BC Admin Center API v2.28</strong> â€” directly from within BC.
      </p>

      <h2 id="fields">Environment fields</h2>
      <p>Primary key: <code>Customer No.</code> + <code>Tenant ID</code> + <code>Name</code></p>
      <div class="table-wrapper">
        <table>
          <thead><tr><th>Field</th><th>Description</th></tr></thead>
          <tbody>
            <tr><td>Name</td><td>Environment name as it appears in the BC Admin Center (e.g. <code>Production</code>, <code>Sandbox</code>).</td></tr>
            <tr><td>Type</td><td>Environment type string from the API: <em>Production</em> or <em>Sandbox</em>.</td></tr>
            <tr><td>State</td><td>Current state from the API (e.g. <em>Active</em>, <em>Preparing</em>, <em>Deleting</em>).</td></tr>
            <tr><td>Country Code</td><td>Two-letter localization code (e.g. <code>IT</code>, <code>DE</code>, <code>US</code>).</td></tr>
            <tr><td>Version</td><td>Currently installed BC application version.</td></tr>
            <tr><td>Application Insights String</td><td>Azure Application Insights connection string for telemetry. Used by the <a href="telemetry.html">Telemetry</a> module.</td></tr>
            <tr><td>Target Version</td><td>Update target version selected for scheduling.</td></tr>
            <tr><td>Selected DateTime</td><td>Scheduled date/time for the queued update.</td></tr>
            <tr><td>Ignore Update Window</td><td>When <code>true</code>, bypasses the configured maintenance window.</td></tr>
          </tbody>
        </table>
      </div>

      <h2 id="lifecycle">Lifecycle operations</h2>
      <div class="table-wrapper">
        <table>
          <thead><tr><th>Action</th><th>API call</th><th>Description</th></tr></thead>
          <tbody>
            <tr><td>Refresh Environments</td><td>GET .../environments</td><td>Fetches all environments from the Admin API and upserts them. Run from the Tenant Card.</td></tr>
            <tr><td>New Environment</td><td>PUT .../environments/{name}</td><td>Creates a new environment. Enter name, type (<em>Sandbox</em>), and country code in the dialog.</td></tr>
            <tr><td>Copy Environment</td><td>POST .../environments/{name}/copy</td><td>Copies an existing environment to a new name and/or type. Useful for creating test copies of production.</td></tr>
            <tr><td>Rename Environment</td><td>POST .../environments/{name}/rename/</td><td>Renames an environment. Note: some BC environments cannot be renamed (e.g. Production on certain plans).</td></tr>
            <tr><td>Delete Environment</td><td>DELETE .../environments/{name}</td><td>Marks the environment for deletion. This is irreversible â€” ensure a backup exists first.</td></tr>
          </tbody>
        </table>
      </div>

      <div class="callout callout--danger">
        <div class="callout__title">Irreversible operations</div>
        <strong>Delete Environment</strong> cannot be undone. Always
        <a href="backup.html">export a backup</a> before deleting a production or important sandbox environment.
      </div>

      <h2 id="updates">Update management</h2>
      <p>
        CCMS provides a full update scheduling workflow directly from the Environment Card.
      </p>
      <div class="table-wrapper">
        <table>
          <thead><tr><th>Action</th><th>Description</th></tr></thead>
          <tbody>
            <tr><td>Get Available Updates</td><td>Fetches all available BC update versions from the Admin API and populates a selection list.</td></tr>
            <tr><td>Select Target Version</td><td>Opens the <em>Update Selection Dialog</em>. Choose a version and optional scheduled date/time; submits via <code>PATCH .../updates/{version}</code>.</td></tr>
            <tr><td>Reschedule Update</td><td>Changes the scheduled date/time for a queued update without reselecting the version.</td></tr>
            <tr><td>Get All Available App Updates</td><td>Batch-fetches available extension updates for all active environments with a progress dialog.</td></tr>
          </tbody>
        </table>
      </div>

      <h2 id="appinsights">Application Insights</h2>
      <p>
        Set the <strong>Application Insights String</strong> field on the Environment Card to
        link the environment with an Azure Application Insights resource.
        Use the <em>Set Application Insights Key</em> action to push this value to the Admin API
        (<code>POST .../settings/appinsightskey</code>).
        Once set, the <a href="telemetry.html">Telemetry</a> module can execute KQL queries against
        this environment's telemetry stream.
      </p>

      <h2 id="child-modules">Child modules</h2>
      <p>From the Environment Card you can navigate to all environment-scoped features:</p>
      <div class="card-grid">
        <a class="card" href="extension.html"><div class="card__icon">ğŸ§©</div><div class="card__title">Extensions</div><div class="card__desc">Installed apps and available updates.</div></a>
        <a class="card" href="backup.html"><div class="card__icon">ğŸ’¾</div><div class="card__title">Backup</div><div class="card__desc">Export history and new export actions.</div></a>
        <a class="card" href="capacity.html"><div class="card__icon">ğŸ“Š</div><div class="card__title">Capacity</div><div class="card__desc">Storage usage per category.</div></a>
        <a class="card" href="features.html"><div class="card__icon">ğŸš¦</div><div class="card__title">Features</div><div class="card__desc">Feature flags and their state.</div></a>
        <a class="card" href="session.html"><div class="card__icon">ğŸ‘¤</div><div class="card__title">Sessions</div><div class="card__desc">Active sessions with stop action.</div></a>
        <a class="card" href="operation.html"><div class="card__icon">â³</div><div class="card__title">Operations</div><div class="card__desc">Async job status tracking.</div></a>
      </div>

    </div>
  </main>
</div>

<footer class="footer">
  &copy; Directions for Partners &bull; Cloud Customer Management Solution v0.0.2.0
</footer>
<script src="js/nav.js"></script>
</body>
</html>
